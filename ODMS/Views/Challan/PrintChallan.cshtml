@using ODMS.HtmlHelpers
@model ODMS.Models.ViewModel.ChallaniVm



<style>
    .sales_order {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        font-size: 10px;
        width: 100%;
    }

    .challanInfo {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        font-size: 10px;
        border: 0 solid black;
    }

    td {
        border: 1px solid #dddddd;
        text-align: left;
        font-size: 12px;
    }

    th {
        border: 1px solid #dddddd;
        text-align: left;
    }
</style>
<table class="challanInfo">
    <tr class="challanInfo">
        <td class="challanInfo">
            <table class="challanInfo">
                <tr>
                    <th class="challanInfo" colspan="3" style="text-align: left; width: 150px">
                        <h1>
                            @Model.Dbname
                        </h1>
                        <h3>
                            @Model.DbAddress
                        </h3>
                    </th>


                </tr>
                <tr>
                    <th class="challanInfo" style="text-align: left; width: 150px">
                        PSR Name
                    </th>
                    <th class="challanInfo" style="width: 10px">
                        :
                    </th>
                    <th class="challanInfo" style="text-align: left; width: 200px">

                        @Model.PsrName



                    </th>

                </tr>

                <tr>
                    <th class="challanInfo" style="text-align: left; width: 150px">
                        Sub Route Name
                    </th>
                    <th class="challanInfo" style="width: 10px">
                        :
                    </th>
                    <th class="challanInfo" style="text-align: left; width: 200px">

                        @Model.RouteName


                    </th>
                </tr>
                <tr>
                    <th class="challanInfo" style="text-align: left; width: 150px">
                        Order Date
                    </th>
                    <th class="challanInfo" style="width: 10px">
                        :
                    </th>
                    <th class="challanInfo" style="text-align: left; width: 200px">
                        @Model.OrderDate.ToString("dd-MM-yyyy")
                    </th>
                </tr>
                <tr>
                    <th class="challanInfo" style="text-align: left; width: 150px">
                        Number of Memo
                    </th>
                    <th class="challanInfo">
                        :
                    </th>
                    <th class="challanInfo" style="text-align: left; width: 200px">
                        @Model.NoOfMemo
                    </th>


                </tr>

            </table>
        </td>
        <td class="challanInfo">
            <table class="challanInfo">
                <tr class="challanInfo">
                 
                    <th colspan="3" class="challanInfo" style="text-align: left; width: 150px">
                   
                        <br/>
                        <br/>
                        <br/>
                        
                        <br/>
                    </th>

                </tr>
                <tr class="challanInfo">
                 
                    <th class="challanInfo" style="text-align: left; width: 150px">
                        Print Date & Time
                    </th>
                    <th class="challanInfo" style="width: 10px">
                        :
                    </th>
                    <th class="challanInfo" style="text-align: left; width: 200px">
                        @DateTime.Now.ToString("yyyy MMMM dd hh:MM.ss tt")
                       



                    </th>

                </tr>
                <tr>
                    <th class="challanInfo" style="text-align: left; width: 150px">
                        Delivery Man  
                    </th>
                    <th class="challanInfo" style="width: 10px">
                        :
                    </th>
                    <th class="challanInfo" style="text-align: left; width: 200px">

                       



                    </th>

                </tr>

                <tr>
                    <th class="challanInfo" style="text-align: left; width: 150px">
                        Driver 
                    </th>
                    <th class="challanInfo" style="width: 10px">
                        :
                    </th>
                    <th class="challanInfo" style="text-align: left; width: 200px">

                        


                    </th>
                </tr>
                <tr>
                    <th class="challanInfo" style="text-align: left; width: 150px">
                        Delivery Date
                    </th>
                    <th class="challanInfo" style="width: 10px">
                        :
                    </th>
                    <th class="challanInfo" style="text-align: left; width: 200px">
                        @Model.DeliveryDate.ToString("dd-MM-yyyy")
                    </th>
                </tr>
                <tr>
                    <th class="challanInfo" style="text-align: left; width: 150px">
                        Challan No    
                    </th>
                    <th class="challanInfo">
                        :
                    </th>
                    <th class="challanInfo" style="text-align: left; width: 200px">
                        @Model.ChallanNumber
                    </th>


                </tr>

            </table>
        </td>
    </tr>
</table>


<br><br>
<table class="sales_order" id="sales_order">
    <thead>
        <tr>

            <th rowspan="2">
                SL
            </th>
            <th style="width: 150px;" rowspan="2">
                SKU Name
            </th>
            <th rowspan="2">
                Betch
            </th>

            <th rowspan="2">
                Price [CS]
            </th>
            <th style="text-align: center; max-width: 5%;" colspan="2">
                Order Qty
            </th>
            <th style="text-align: center; max-width: 5%;" colspan="2">
                Extra Qty
            </th>
            <th style="text-align: center; max-width: 5%;" colspan="2">
                Total  Qty
            </th>


            <th style="text-align: center; max-width: 5%;" colspan="2">
                Total Delivery Qty
            </th>
            <th style="text-align: center; max-width: 5%;">
                Free Qty
            </th>
            <th style="text-align: center; max-width: 5%;" colspan="2">
                Return Qty
            </th>
            <th style="text-align: center; max-width: 5%;" rowspan="2">
                Order <br /> Amount
            </th>
            <th style="text-align: center; max-width: 5%;" rowspan="2">
                Delevery <br /> Amount
            </th>
        </tr>
        <tr>
            <th style="text-align: center; max-width: 30px;">
                CS
            </th>
            <th style="text-align: center; max-width: 30px;">
                PCS
            </th>
            <th style="text-align: center; max-width: 30px;">
                CS
            </th>

            <th style="text-align: center; max-width: 30px;">
                PCS
            </th>
            <th style="text-align: center; max-width: 30px;">
                CS
            </th>
            <th style="text-align: center; max-width: 30px;">
                PCS
            </th>
            <th style="text-align: center; max-width: 30px;">
                CS
            </th>
            <th style="text-align: center; max-width: 30px;">
                PCS
            </th>

            <th style="text-align: center; max-width: 30px;">
                PCS
            </th>
            <th style="text-align: center; max-width: 30px;">
                CS
            </th>
            <th style="text-align: center; max-width: 30px;">
                PCS
            </th>



        </tr>
    </thead>
    <tbody  id="tbody_order">

        @{
            var sl = 1;
            Double grandTotalCs = 0;
            Double deliveryGrandTotalCs = 0;
            Double grandTotalOrderAmount = 0;
            Double grandTotalDeliveryAmount = 0;

        }


        @foreach (var item in Model.Challanline)
        {
            <tr>


                @{
            var deliverygap = item.ReturnQty;

            int csPrice = (int)(item.Price * item.PackSize);



            var deliverygapCs = deliverygap / item.PackSize;
            var deliverygapPs = deliverygap % item.PackSize;


            var extraQtyCs = item.ExtraQty / item.PackSize;
            var extraQtyPs = item.ExtraQty % item.PackSize;


            grandTotalCs += (Double)item.TotalQty / item.PackSize;
            deliveryGrandTotalCs += (Double)item.ConfirmQty / item.PackSize;

            grandTotalOrderAmount += item.OrderQtyPrice;
            grandTotalDeliveryAmount += item.ConfirmQtyPrice;
                }

                <td>

                    @sl

                    @{
            sl++;
                    }

                </td>

                <td style="text-align: left; width: 200px;">

                    @item.SkuName


                </td>
                <td style="text-align: center;">
                    @item.BatchId
                </td>
                <td style="text-align: center;">

                    @csPrice.ToString("N")


                </td>

                <td style="text-align: center;">

                    @item.OrderCsQty.EmptyIfZero()

                </td>
                <td style="text-align: center;">
                    @item.OrderPsQty.EmptyIfZero()

                </td>
                <td style="text-align: center;">

                    @extraQtyCs.EmptyIfZero()

                </td>
                <td style="text-align: center;">
                    @extraQtyPs.EmptyIfZero()

                </td>
                <td style="text-align: center;">

                    @item.TotalCsQty.EmptyIfZero()

                </td>
                <td style="text-align: center;">
                    @item.TotalPsQty.EmptyIfZero()

                </td>
                <td style="text-align: center;">
                    @if (Model.ChallanStatus == 2)
                    {@item.ConfirmCsQty.EmptyIfZero()}
                </td>
                     <td style="text-align: center;">
                    @if (Model.ChallanStatus == 2)
                    {@item.ConfirmPsQty.EmptyIfZero()}
                </td>

                     <td style="text-align: center;">
                    @item.FreeQty.EmptyIfZero()
                </td>

                     <td style="text-align: center;">
                    @if (Model.ChallanStatus == 2)
                    {@deliverygapCs.EmptyIfZero()
                    }

                </td>
                     <td style="text-align: center;">
                    @if (Model.ChallanStatus == 2)
                    {
                        @deliverygapPs.EmptyIfZero()
                            
                    }



                </td>
                     <td style="text-align:right;">

                    @item.OrderQtyPrice.ToString("N")

                </td>

                     <td style="text-align: right;">
                    @if (Model.ChallanStatus == 2)
                    {
                        @item.ConfirmQtyPrice.ToString("N")
                            
                    }
                </td>





            </tr>
        }

    </tbody>
    <tfoot>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        
            <td colspan="4" style="text-align: right;">Gross Total</td>
            <td style="text-align: center;" colspan="2">
                @grandTotalCs.ToString("#.##")
            </td>

            <td style="text-align: center;" colspan="2">
                @deliveryGrandTotalCs.ToString("#.##")
            </td>

            <td></td>
            <td colspan="2"></td>
            <td style="text-align: right;">
                @grandTotalOrderAmount.ToString("#.##")
            </td>
            <td style="text-align: right;">
                @grandTotalDeliveryAmount.ToString("#.##")
            </td>
        </tr>



    </tfoot>
</table>


<script type="text/javascript">
    window.print();
     setTimeout('window.close()', 500);
</script>
